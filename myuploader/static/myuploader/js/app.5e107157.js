(function(t){function e(e){for(var n,a,s=e[0],c=e[1],p=e[2],l=0,u=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&u.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);d&&d(e);while(u.length)u.shift()();return r.push.apply(r,p||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,s=1;s<i.length;s++){var c=i[s];0!==o[c]&&(n=!1)}n&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},o={app:0},r=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/uploader/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var p=0;p<s.length;p++)e(s[p]);var d=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"1fd5":function(t,e,i){"use strict";i("85c3")},"2f22":function(t,e,i){"use strict";i("44c3")},"44c3":function(t,e,i){},4579:function(t,e,i){t.exports=i.p+"../static/myuploader/img/add_file.3b5e0727.svg"},"46c7":function(t,e,i){t.exports=i.p+"../static/myuploader/img/file.d808ee99.svg"},"56d7":function(t,e,i){"use strict";i.r(e);var n=i("3835"),o=i("b85c"),r=(i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("d3b7"),i("ac1f"),i("1276"),i("498a"),i("2b0e")),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t._m(0),i("main",{attrs:{id:"main"}},[i("transition",{attrs:{appear:""}},[i("router-view")],1)],1)])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{attrs:{if:"side"}},[n("img",{attrs:{src:i("9b19"),id:"header-logo"}})])}],c={name:"app"},p=c,d=(i("034f"),i("2877")),l=Object(d["a"])(p,a,s,!1,null,null,null),u=l.exports,m=i("8c4f"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{key:t.getKey,attrs:{id:"composites"}},[i("div",{attrs:{id:"list"}},[t.current.parent?i("div",{key:t.current.parent.pk,staticClass:"parent composite-wrapper"},[i("Composite",{attrs:{data:t.current.parent},on:{click:t.moveBefore}})],1):t.current.pk?i("div",{key:-1,staticClass:"parent composite-wrapper"},[i("Composite",{attrs:{data:{name:"home",is_dir:"true"}},on:{click:t.moveBefore}})],1):t._e(),t.current.pk?i("div",{key:t.current.pk,staticClass:"current composite-wrapper"},[i("Composite",{attrs:{data:t.current,editableIn:!0},on:{createDir:t.createDir,createFile:t.createFile}})],1):i("div",{key:-1,staticClass:"current composite-wrapper"},[i("Composite",{attrs:{data:{name:"home",is_dir:"true"},editableIn:!0},on:{createDir:t.createDir,createFile:t.createFile}})],1),t._l(t.current.composite_set,(function(e){return i("div",{key:e.pk,staticClass:"child composite-wrapper"},[i("Composite",{attrs:{data:e,zipUrl:t.zipUrl(e),editable:!0},on:{click:t.move,remove:t.remove,update:t.update}})],1)}))],2),i("div",{attrs:{id:"form"}},[i("composite-form",{key:t.selected.type+"-"+t.selected.data.pk,attrs:{selected:t.selected},on:{done:t.reload,close:t.close}})],1)])},h=[],v=(i("8a79"),i("b0c0"),i("a15b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"composite"},[t.data.is_dir?n("img",{staticClass:"dir-icon",attrs:{src:i("b5d9")}}):n("img",{staticClass:"file-icon",attrs:{src:i("46c7")}}),t.data.pk?n("span",{staticClass:"id"},[t._v(t._s(t.data.pk))]):t._e(),n("a",{staticClass:"composite-link",on:{click:t.onclick}},[t._v(t._s(t.data.name))]),t.editableIn?[n("button",{staticClass:"img-button add-dir",attrs:{type:"button"},on:{click:t.createFile}},[n("img",{staticClass:"add-file-button-icon",attrs:{src:i("4579")}})]),n("button",{staticClass:"img-button add-file",attrs:{type:"button"},on:{click:t.createDir}},[n("img",{staticClass:"add-dir-button-icon",attrs:{src:i("6e7a")}})])]:t._e(),t.editable?[n("button",{staticClass:"img-button update",attrs:{type:"button"},on:{click:t.update}},[n("img",{staticClass:"update-button-icon",attrs:{src:i("8124")}})]),n("button",{staticClass:"img-button delete",attrs:{type:"button"},on:{click:t.remove}},[n("img",{staticClass:"delete-button-icon",attrs:{src:i("d739")}})]),t.data.zip_depth?n("a",{staticClass:"img-button zip",attrs:{href:t.zipUrl}},[n("img",{staticClass:"zip-button-icon",attrs:{src:i("d60a")}})]):t._e()]:t._e()],2)}),y=[],g={name:"composite",props:{data:{type:Object},editable:{type:Boolean,default:!1},editableIn:{type:Boolean,default:!1},zipUrl:{type:String}},methods:{onclick:function(){this.$emit("click",this.data)},update:function(){this.$emit("update",this.data)},remove:function(){this.$emit("remove",this.data)},createFile:function(){this.$emit("createFile",this.data)},createDir:function(){this.$emit("createDir",this.data)}}},b=g,_=(i("85e3"),Object(d["a"])(b,v,y,!1,null,"46421e12",null)),k=_.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return"delete"===t.selected.type?i("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.remove.apply(null,arguments)}}},[i("p",[t._v(t._s(t.selected.data.name)+"の削除")]),i("button",{attrs:{type:"submit"}},[t._v("削除")]),i("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):"new"===t.selected.type?i("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.add.apply(null,arguments)}}},[i("p",[t._v("新規作成")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],attrs:{type:"text",placeholder:"名前"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),t.selected.data.is_dir?i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.zip_depth,expression:"form.zip_depth"}],attrs:{type:"number",placeholder:"ZIP階層"},domProps:{value:t.form.zip_depth},on:{input:function(e){e.target.composing||t.$set(t.form,"zip_depth",e.target.value)}}})]):i("div",[i("input",{ref:"upfile",attrs:{type:"file"}})]),i("button",{attrs:{type:"submit"}},[t._v("送信")]),i("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):"update"===t.selected.type?i("form",{staticClass:"composite-form",on:{submit:function(e){return e.preventDefault(),t.update.apply(null,arguments)}}},[i("p",[t._v(t._s(t.selected.data.name)+"の更新")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],attrs:{type:"text",placeholder:"名前"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.parent,expression:"form.parent"}],attrs:{type:"text",placeholder:"親ディレクトリID"},domProps:{value:t.form.parent},on:{input:function(e){e.target.composing||t.$set(t.form,"parent",e.target.value)}}}),t.selected.data.is_dir?i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.form.zip_depth,expression:"form.zip_depth"}],attrs:{type:"number",placeholder:"ZIP階層"},domProps:{value:t.form.zip_depth},on:{input:function(e){e.target.composing||t.$set(t.form,"zip_depth",e.target.value)}}})]):i("div",[i("input",{ref:"upfile",attrs:{type:"file"}})]),i("button",{attrs:{type:"submit"}},[t._v("更新")]),i("button",{staticClass:"button-link",on:{click:t.close}},[t._v("閉じる")])]):t._e()},C=[],x=(i("e9c4"),{name:"composite-form",props:{selected:{type:Object}},data:function(){return{form:{name:"",zip_depth:0,parent:""}}},mounted:function(){"update"===this.selected.type&&(this.form.name=this.selected.data.name,this.form.zip_depth=this.selected.data.zip_depth,this.form.parent=this.selected.data.parent?this.selected.data.parent:"")},methods:{add:function(){var t=this,e=new FormData;if(e.append("name",this.form.name),e.append("is_dir",this.selected.data.is_dir),this.selected.data.is_dir)e.append("zip_depth",this.form.zip_depth);else{var i=this.$refs.upfile.files[0];i&&e.append("src",i)}e.append("parent",this.selected.data.parent),this.$http(this.$endpoint,{credentials:"include",method:"POST",body:e,headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){return e.ok?e.json().then((function(){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.form.name+"を追加しました"),duration:2e3}),t.$emit("done")})):e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}))}))},update:function(){var t=this,e=new FormData;if(e.append("name",this.form.name),e.append("is_dir",this.selected.data.is_dir),this.selected.data.is_dir)e.append("zip_depth",this.form.zip_depth);else{var i=this.$refs.upfile.files[0];i&&e.append("src",i)}e.append("parent",this.form.parent),this.$http(this.$endpoint+this.selected.data.pk+"/",{credentials:"include",method:"PATCH",body:e,headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){return e.ok?e.json().then((function(){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.form.name+"を更新しました"),duration:2e3}),t.$emit("done")})):e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}))}))},remove:function(){var t=this;this.$http(this.$endpoint+this.selected.data.pk+"/",{credentials:"include",method:"DELETE",headers:{"X-CSRFToken":this.$csrfToken}}).then((function(e){if(!e.ok)return e.json().then((function(e){t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #900"},JSON.stringify(e)),duration:2e3})}));t.$notify({title:"お知らせ",message:t.$createElement("p",{style:"color: #009"},t.selected.data.name+"を削除しました"),duration:2e3}),t.$emit("done")}))},close:function(){this.$emit("close")}}}),w=x,j=(i("2f22"),Object(d["a"])(w,$,C,!1,null,"6cb7f0e0",null)),z=j.exports,P={name:"composite-list",props:{path:{type:String}},components:{Composite:k,CompositeForm:z},data:function(){return{current:{},selected:{type:null,data:{}}}},created:function(){this.path?this.getCompositeListFromPath(this.path):this.getCompositeListTop()},methods:{getCompositeListTop:function(){var t=this;this.$http(this.$endpoint).then((function(t){return t.json()})).then((function(e){t.current={composite_set:e}}))},getCompositeListFromPk:function(t){var e=this;this.$http(this.$endpoint+t+"/").then((function(t){return t.json()})).then((function(t){e.current=t}))},getCompositeListFromPath:function(t){var e=this;this.$http(this.$endpoint+"get_composite_from_path/"+t).then((function(t){return t.json()})).then((function(t){e.current=t}))},move:function(t){var e=this.getNextPath(t);t.is_dir?(this.$router.push(e),this.getCompositeListFromPk(t.pk)):window.open(this.$fileUrlBase+e,"_blank")},getNextPath:function(t){var e=this.$route.path;e.endsWith("/")||(e+="/");var i=e+t.name;return t.is_dir&&(i+="/"),i},getBeforePath:function(){var t,e=[],i=Object(o["a"])(this.$route.path.split("/"));try{for(i.s();!(t=i.n()).done;){var n=t.value;n&&e.push(n)}}catch(r){i.e(r)}finally{i.f()}return e.pop(),"/"+e.join("/")+"/"},moveBefore:function(){var t=this.getBeforePath();this.$router.push(t),this.current.parent?this.getCompositeListFromPk(this.current.parent.pk):this.getCompositeListTop()},update:function(t){this.selected.data=t,this.selected.type="update",document.getElementById("form").style.padding="10px"},remove:function(t){this.selected.data=t,this.selected.type="delete",document.getElementById("form").style.padding="10px"},createFile:function(t){this.selected.data={is_dir:!1,parent:t.pk?t.pk:""},this.selected.type="new",document.getElementById("form").style.padding="10px"},createDir:function(t){this.selected.data={is_dir:!0,parent:t.pk?t.pk:""},this.selected.type="new",document.getElementById("form").style.padding="10px"},zipUrl:function(t){return this.$zipUrlBase+t.pk+"/"},reload:function(){this.selected.type=null,this.selected.data={},this.current.pk?this.getCompositeListFromPk(this.current.pk):this.getCompositeListTop()},close:function(){this.selected.data={},this.selected.type=null,document.getElementById("form").style.padding="0px"}},computed:{getKey:function(){return"".concat(this.current.pk)}}},O=P,F=(i("1fd5"),Object(d["a"])(O,f,h,!1,null,"281fb8d2",null)),E=F.exports;r["a"].use(m["a"]);var T=[{path:"/home/:path*",name:"home",component:E,props:!0}],B=new m["a"]({mode:"history",base:"/uploader/",routes:T}),D=B;r["a"].config.productionTip=!1,r["a"].prototype.$http=function(t,e){return fetch(t,e)},r["a"].prototype.$endpoint="/uploader/api/composites/",r["a"].prototype.$fileUrlBase="/uploader",r["a"].prototype.$zipUrlBase="/uploader/zip/";var S=function(t){if(document.cookie&&""!==document.cookie){var e,i=Object(o["a"])(document.cookie.split(";"));try{for(i.s();!(e=i.n()).done;){var r=e.value,a=r.trim().split("="),s=Object(n["a"])(a,2),c=s[0],p=s[1];if(c===t)return decodeURIComponent(p)}}catch(d){i.e(d)}finally{i.f()}}};r["a"].prototype.$csrfToken=S("csrftoken"),new r["a"]({router:D,render:function(t){return t(u)}}).$mount("#app")},"6e7a":function(t,e,i){t.exports=i.p+"../static/myuploader/img/add_dir.e94695c0.svg"},"731c":function(t,e,i){},8124:function(t,e,i){t.exports=i.p+"../static/myuploader/img/update.1c6917b7.svg"},"85c3":function(t,e,i){},"85e3":function(t,e,i){"use strict";i("731c")},"85ec":function(t,e,i){},"9b19":function(t,e,i){t.exports=i.p+"../static/myuploader/img/logo.36d11cf1.svg"},b5d9:function(t,e,i){t.exports=i.p+"../static/myuploader/img/dir.526cb8f2.svg"},d60a:function(t,e,i){t.exports=i.p+"../static/myuploader/img/zip.89072fe7.svg"},d739:function(t,e,i){t.exports=i.p+"../static/myuploader/img/delete.b38574ef.svg"}});
//# sourceMappingURL=app.5e107157.js.map